<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汪佑霖 Wang You-Lin | 海洋氣候變遷研究室</title>
    
    <!-- SEO & Social Media Preview -->
    <meta name="description" content="汪佑霖 (Wang You-Lin) 個人學術網站。專注於海洋氣候變遷、離岸風電風險評估與物理海洋學研究。">
    <meta property="og:title" content="汪佑霖 | 海洋氣候變遷研究室 (MCCR Lab)" />
    <meta property="og:description" content="探索海洋科學與數據的交匯點。瀏覽我的研究著作、開授課程以及最新的海洋能源氣候風險評估模型。" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1497436072909-60f360e1d4b0?q=80&w=1200&auto=format&fit=crop" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8f9fa;
            color: #334155;
        }

        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .nav-item.active {
            background-color: #0f766e;
            color: white;
            border-right: 4px solid #134e4a;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .nav-item { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .nav-item:hover:not(.active) { background-color: #e2e8f0; padding-left: 1.5rem; }

        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            overflow: hidden;
        }
        .dash-chart-height {
            height: 350px;
        }
    </style>
</head>
<body class="antialiased selection:bg-teal-200 selection:text-teal-900 h-screen overflow-hidden flex flex-col">

    <!-- Top Header -->
    <header class="bg-white border-b border-slate-200 shadow-sm z-20 flex-none h-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-teal-700 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-md">
                    汪
                </div>
                <div>
                    <h1 class="text-lg font-bold text-slate-800 leading-none">汪佑霖 Wang You-Lin</h1>
                    <p class="text-xs text-slate-500 mt-1 uppercase tracking-wider">海洋氣候變遷研究室 (MCCR Lab)</p>
                </div>
            </div>
            <div class="hidden md:flex items-center space-x-4 text-sm text-slate-500">
                <a href="mailto:ylwang@mail.ntou.edu.tw" class="hover:text-teal-600 transition-colors"><i class="fas fa-envelope mr-1"></i> 聯絡我</a>
                <a href="https://github.com/" target="_blank" class="hover:text-teal-600 transition-colors"><i class="fab fa-github mr-1"></i> GitHub</a>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex-grow flex overflow-hidden max-w-7xl mx-auto w-full">
        
        <!-- Sidebar Navigation (Left) -->
        <aside class="w-64 flex-none bg-white border-r border-slate-200 hidden md:flex flex-col z-10">
            <div class="p-6">
                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">MENU</h3>
                <nav class="space-y-2" id="desktop-nav"></nav>
            </div>
            <div class="mt-auto p-6 border-t border-slate-100">
                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                    <h4 class="text-xs font-bold text-slate-600 mb-2">最新動態</h4>
                    <p class="text-xs text-slate-500 leading-relaxed">
                        2025年最新研究「黑潮發電潛力低估」已發表於 <span class="italic">Applied Energy</span> 期刊。
                    </p>
                </div>
            </div>
        </aside>

        <!-- Mobile Nav (Bottom) -->
        <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 z-50 flex justify-around p-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]" id="mobile-nav"></div>

        <!-- Center Content (Dynamic) -->
        <main class="flex-grow flex flex-col overflow-hidden relative bg-slate-50/50">
            <div id="main-content" class="flex-grow overflow-y-auto custom-scroll p-4 md:p-8 pb-24 md:pb-8">
                <!-- Content injected here -->
            </div>
        </main>
    </div>

    <!-- JavaScript Application Logic -->
    <script>
        // --- 1. 資料庫 (Data) - 完整研究著作列表 ---
        const publicationsData = [
            // Journals (18 items)
            { type: 'journal', year: 2025, title: 'Underestimated Kuroshio power and its potential sites off southeast Taiwan', authors: 'Chang, Y.-C., C.-R. Wu*, P. C. Chu, <b>Y.-L. Wang</b>, L. R. Centurioni, G.-Y. Chen, and R.-S. Tseng', journal: 'Applied Energy', vol: '396, 126316', link: 'https://doi.org/10.1016/j.apenergy.2025.126316', badge: 'IF: 11.2' },
            { type: 'journal', year: 2024, title: 'Northwestern Pacific oceanic circulation shaped by ENSO', authors: '<b>Wang, Y.-L.</b>*, F.-F. Jin, C.-R. Wu*, and B. Qiu', journal: 'Scientific Reports', vol: '14, 11684', link: 'https://doi.org/10.1038/s41598-024-62361-z', badge: 'Nature Portfolio' },
            { type: 'journal', year: 2023, title: 'Increased tropical South Pacific western boundary current transport over the past century', authors: 'Chen, W.-H.*, H. Ren*, J. Chiang, <b>Y.-L. Wang</b>, R.-Y. Cai-Li, Y.-C. Chen, C.-C. Shen, F. Taylor, T. DeCarlo, C.-R. Wu, H.-S. Mii, and X. Wang', journal: 'Nature Geoscience', vol: '16, 590-596', link: 'https://doi.org/10.1038/s41561-023-01212-4', badge: 'Top Tier' },
            { type: 'journal', year: 2022, title: 'Rapid surface warming of the Pacific Asian marginal seas since the late 1990s', authors: '<b>Wang, Y.-L.</b> and C.-R. Wu', journal: 'Journal of Geophysical Research: Oceans', vol: '127(12), e2022JC018744', link: 'https://doi.org/10.1029/2022JC018744', badge: 'AGU' },
            { type: 'journal', year: 2022, title: 'Response of planktonic foraminifera to seasonal and interannual hydrographic changes: Sediment trap record from the northern South China Sea', authors: 'Lin, H.-L., H.-K. Lui, T.-C. Lin, and <b>Y.-L. Wang</b>', journal: 'Frontiers in Earth Science', vol: '', link: 'https://doi.org/10.3389/feart.2022.928115', badge: '' },
            { type: 'journal', year: 2020, title: 'Intrusion of Kuroshio helps to diminish coastal hypoxia in the coast of northern South China Sea', authors: 'Lui, H.-K., C.-T. A. Chen, W.-P. Hou, J.-M. Liau, W.-C. Chou, <b>Y.-L. Wang</b>, C.-R. Wu, J. Lee, Y.-C. Hsin, Y.-Y. Choi', journal: 'Frontiers in Marine Science', vol: '7, 788', link: 'https://doi.org/10.3389/fmars.2020.565952', badge: '' },
            { type: 'journal', year: 2020, title: 'Nonstationary El Niño teleconnection on the post-summer upwelling off Vietnam', authors: '<b>Wang, Y.-L.</b> and C.-R. Wu', journal: 'Scientific Reports', vol: '', link: 'https://doi.org/10.1038/s41598-020-70147-2', badge: '' },
            { type: 'journal', year: 2019, title: 'Disassociation of the Kuroshio Current with the Pacific Decadal Oscillation since 1999', authors: 'Wu, C.-R., <b>Y.-L. Wang</b>, and S.-Y. Chao', journal: 'Remote Sensing', vol: '11(3), 276', link: 'http://doi.org/10.3390/rs11030276', badge: '' },
            { type: 'journal', year: 2019, title: 'Enhanced warming and intensification of the Kuroshio Extension, 1999-2013', authors: '<b>Wang, Y.-L.</b>, and C.-R. Wu', journal: 'Remote Sensing', vol: '11(1), 101', link: 'http://doi.org/10.3390/rs11010101', badge: '' },
            { type: 'journal', year: 2019, title: 'An Atlantic-driven rapid circulation change in the North Pacific Ocean during the late 1990s', authors: 'Wu, C.-R., Y.-F. Lin, <b>Y.-L. Wang</b>, N. Keenlyside, and J.-Y. Yu', journal: 'Scientific Reports', vol: '9, 14411', link: 'https://doi.org/10.1038/s41598-019-51076-1', badge: '' },
            { type: 'journal', year: 2019, title: 'Coupling influences of ENSO and PDO on the inter-decadal SST variability of the ACC around the western South Atlantic', authors: '<b>Wang, Y.-L.</b>, Y.-C. Hsu, C.-P. Lee, and C.-R. Wu', journal: 'Sustainability', vol: '11(18), 4853', link: 'https://doi.org/10.3390/su11184853', badge: '' },
            { type: 'journal', year: 2019, title: 'East China Sea increasingly gains limiting nutrient P from South China Sea', authors: 'Huang, T.-H., C.-T. A. Chen, J. Lee, C.-R. Wu, <b>Y.-L. Wang</b>, Y. Bai, X. He, S.-L. Wang, S. Kandasamy, J.-Y. Lou, B.-J. Tsuang, H.-W. Chen, R.-S. Tseng, and Y.-J. Yang', journal: 'Scientific Reports', vol: '9, 5648', link: 'http://doi.org/10.1038/s41598-019-42020-4', badge: '' },
            { type: 'journal', year: 2019, title: 'Coherent response of Vietnam and Sumatra-Java upwellings to cross-equatorial winds', authors: 'Wu, C.-R., L.-C. Wang, <b>Y.-L. Wang</b>, Y.-F. Lin, T.-L. Chiang, and Y.-C. Hsin', journal: 'Scientific Reports', vol: '9, 3650', link: 'http://doi.org/10.1038/s41598-019-40246-w', badge: '' },
            { type: 'journal', year: 2018, title: 'Discordant multi-decadal trend in the intensity of the Kuroshio along its path during 1993-2013', authors: '<b>Wang, Y.-L.</b>, C.-R. Wu', journal: 'Scientific Reports', vol: '8, 14633', link: 'https://doi.org/10.1038/s41598-018-32843-y', badge: '' },
            { type: 'journal', year: 2018, title: 'Leading El-Niño SST Oscillations around the southern south American continent', authors: 'Hsu, Y.-C., C.-P. Lee, <b>Y.-L. Wang</b>, C.-R. Wu, and H.-K. Lui', journal: 'Sustainability', vol: '10(6), 1783', link: 'https://doi.org/10.3390/su10061783', badge: '' },
            { type: 'journal', year: 2017, title: 'Intrusion of the Kuroshio into the South and East China Seas', authors: 'Wu, C.-R., <b>Y.-L. Wang</b>, Y.-F. Lin, and S.-Y. Chao', journal: 'Scientific Reports', vol: '7, 7895', link: 'https://doi.org/10.1038/s41598-017-08206-4', badge: '' },
            { type: 'journal', year: 2016, title: 'Warming and weakening trends of the Kuroshio during 1993-2013', authors: '<b>Wang, Y.-L.</b>, C.-R. Wu, and S.-Y. Chao', journal: 'Geophysical Research Letters', vol: '43(17)', link: 'https://doi.org/10.1002/2016GL069432', badge: 'GRL' },
            { type: 'journal', year: 2016, title: 'Weakening of the Kuroshio intrusion into the South China Sea under the global warming hiatus', authors: 'Wu, C.-R., <b>Y.-L. Wang</b>, Y.-F. Lin, T.-L. Chiang, and C.-C. Wu', journal: 'IEEE J. Sel. Top. Appl. Earth Obs. Remote Sens.', vol: '9(11)', link: 'http://doi.org/10.1109/JSTARS.2016.2574941', badge: 'IEEE' },
            // Conferences (3 items)
            { type: 'conf', year: 2016, title: 'Inter-decadal variability of the Antarctic Circumpolar Current (ACC) around the southern South American Continent', authors: 'Y.-C. Hsu, C.-R. Wu, C.-P. Lee, and <b>Y.-L. Wang</b>', journal: 'Proceedings of the 38th Ocean Engineering Conference', vol: '399', link: '#', badge: 'Conf' },
            { type: 'conf', year: 2015, title: 'Interannual Variability of the Antarctic Circumpolar Current (ACC) Around the Southern South American Continent', authors: 'Y.-C. Hsu, C.-R. Wu, C.-P. Lee, and <b>Y.-L. Wang</b>', journal: 'Proceedings of the 37th Ocean Engineering Conference', vol: '427', link: '#', badge: 'Conf' },
            { type: 'conf', year: 2013, title: 'Interannual variability in oceanic circulation near Taiwan', authors: '<b>Y.-L. Wang</b> and C.-R. Wu', journal: 'Proceedings of the 35th Ocean Engineering Conference', vol: '', link: '#', badge: 'Conf' },
            // Books (1 item)
            { type: 'book', year: 2017, title: '海洋系統與變遷 - 臺灣氣候變遷科學報告 2017', authors: '李明安、劉康克、吳朝榮... <b>汪佑霖</b> 等', journal: '國家災害防救科技中心', vol: '第二章', link: '#', badge: 'Book Chapter' }
        ];

        // --- 2. 頁面樣板 (Templates) ---
        const contentTemplates = {
            about: `
                <div class="fade-in grid grid-cols-1 xl:grid-cols-3 gap-8">
                    <div class="xl:col-span-2 space-y-8">
                        <div class="bg-white rounded-xl p-8 border-l-4 border-teal-600 shadow-sm">
                            <h2 class="text-2xl font-bold text-slate-800 mb-4">歡迎來到 MCCR Lab</h2>
                            <p class="text-slate-600 leading-relaxed mb-4">
                                我是汪佑霖，致力於研究<strong>海洋氣候變遷</strong>及其對全球與區域環境的影響。我們的研究室專注於結合數值模擬、遙測資料與現場觀測，探討黑潮變異、極端海氣交互作用以及這些物理過程對海洋再生能源開發的潛在風險。
                            </p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                                <h3 class="text-lg font-bold text-slate-700 mb-3"><i class="fas fa-search text-teal-500 mr-2"></i>研究興趣</h3>
                                <ul class="space-y-2 text-slate-600 text-sm">
                                    <li>• 物理海洋學 (Physical Oceanography)</li>
                                    <li>• 氣候變遷與極端事件 (Climate Change)</li>
                                    <li>• 海洋再生能源評估 (Ocean Energy)</li>
                                    <li>• 黑潮動力學 (Kuroshio Dynamics)</li>
                                </ul>
                            </div>
                            <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                                <h3 class="text-lg font-bold text-slate-700 mb-3"><i class="fas fa-book text-teal-500 mr-2"></i>近期關注</h3>
                                <p class="text-sm text-slate-600 leading-relaxed">
                                    目前我們正致力於建立台灣周邊海域的精細化氣候風險模型，評估未來不同暖化情境下，離岸風電與洋流能開發場址的環境脆弱度。
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="xl:col-span-1 space-y-6">
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 text-center">
                            <div class="w-24 h-24 bg-slate-200 rounded-full mx-auto mb-4 overflow-hidden border-4 border-white shadow-sm relative group">
                                <img src="https://ui-avatars.com/api/?name=Wang+You-Lin&background=0f766e&color=fff&size=128" alt="Profile" class="w-full h-full object-cover">
                            </div>
                            <h2 class="text-lg font-bold text-slate-800">汪佑霖, PhD</h2>
                            <p class="text-sm text-slate-500 mb-4">助理教授 / 研究員</p>
                            <div class="flex justify-center space-x-2 mb-6">
                                <a href="https://scholar.google.com/" target="_blank" class="w-8 h-8 rounded-full bg-slate-100 text-slate-600 flex items-center justify-center hover:bg-teal-500 hover:text-white transition-colors"><i class="fas fa-graduation-cap"></i></a>
                                <a href="mailto:ylwang@mail.ntou.edu.tw" class="w-8 h-8 rounded-full bg-slate-100 text-slate-600 flex items-center justify-center hover:bg-teal-500 hover:text-white transition-colors"><i class="fas fa-envelope"></i></a>
                            </div>
                            <hr class="border-slate-100 my-4">
                            <div class="text-left space-y-3 text-sm">
                                <div class="flex items-center text-slate-600"><i class="fas fa-map-marker-alt w-5 text-teal-600"></i><span>台灣, 基隆市</span></div>
                                <div class="flex items-center text-slate-600"><i class="fas fa-university w-5 text-teal-600"></i><span>國立海洋大學</span></div>
                            </div>
                        </div>
                        <!-- Removed Radar Chart as requested -->
                    </div>
                </div>`,
            courses: `
                <div class="space-y-6 fade-in max-w-5xl mx-auto">
                    <h2 class="text-2xl font-bold text-slate-800 mb-6">開授課程 (Courses)</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-xl overflow-hidden border border-slate-200 shadow-sm flex flex-col hover:shadow-md transition-shadow">
                            <div class="h-2 bg-teal-500"></div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold text-slate-800 mb-1">物理海洋學</h3>
                                <p class="text-slate-500 text-xs mb-4">大學部必修</p>
                                <p class="text-slate-600 text-sm">介紹海洋物理特性的基礎知識，包含溫鹽環流、波浪力學與潮汐理論。</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl overflow-hidden border border-slate-200 shadow-sm flex flex-col hover:shadow-md transition-shadow">
                            <div class="h-2 bg-blue-500"></div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold text-slate-800 mb-1">海洋數據分析</h3>
                                <p class="text-slate-500 text-xs mb-4">研究所選修</p>
                                <p class="text-slate-600 text-sm">運用 Python 與 Matlab 進行海洋觀測數據處理、視覺化以及機器學習應用。</p>
                            </div>
                        </div>
                    </div>
                </div>`,
            dashboard: `
                <div class="fade-in h-full flex flex-col">
                    <div class="mb-6 border-b border-slate-200 pb-4 flex-none">
                        <h2 class="text-2xl font-bold text-slate-800">海洋綠色能源氣候風險儀表板</h2>
                        <p class="text-sm text-slate-600">整合學術文獻與風險模型，評估極端氣候對海洋能源設施的潛在衝擊。</p>
                    </div>
                    <div class="flex-grow overflow-hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full overflow-y-auto custom-scroll pb-20">
                            <!-- Nav -->
                            <div class="lg:col-span-3 space-y-2">
                                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 px-1">能源項目</h3>
                                <div id="dash-nav-container" class="flex flex-col space-y-2"></div>
                            </div>
                            <!-- Center Content (Added ID for scrolling) -->
                            <div id="dash-content-main" class="lg:col-span-5 bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col h-fit">
                                <div class="mb-4 flex items-center justify-between border-b border-slate-100 pb-4">
                                    <h3 id="dash-section-title" class="text-xl font-bold text-slate-800">...</h3>
                                    <span id="dash-risk-badge" class="px-3 py-1 rounded-full text-xs font-medium">...</span>
                                </div>
                                <div class="space-y-6">
                                    <section>
                                        <h4 class="flex items-center text-sm font-bold text-teal-700 mb-2 uppercase"><span class="w-1.5 h-1.5 bg-teal-500 rounded-full mr-2"></span>主要氣候風險</h4>
                                        <p id="dash-desc-text" class="text-slate-600 text-sm leading-6 text-justify"></p>
                                    </section>
                                    <section>
                                        <h4 class="flex items-center text-sm font-bold text-teal-700 mb-2 uppercase"><span class="w-1.5 h-1.5 bg-blue-500 rounded-full mr-2"></span>關鍵文獻證據</h4>
                                        <ul id="dash-citation-list" class="space-y-3 text-xs text-slate-600"></ul>
                                    </section>
                                    <section class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                                        <h4 class="font-bold text-slate-700 mb-1 text-xs uppercase">韌性建議</h4>
                                        <p id="dash-resilience-text" class="text-xs text-slate-500 font-medium"></p>
                                    </section>
                                </div>
                            </div>
                            <!-- Right -->
                            <div class="lg:col-span-4 flex flex-col space-y-4 h-fit">
                                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4 relative">
                                    <h3 class="text-xs font-semibold text-slate-500 mb-2 text-center">脆弱度構面分析</h3>
                                    <div class="chart-container dash-chart-height"><canvas id="radarChart"></canvas></div>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div class="bg-white p-3 rounded-lg shadow-sm border border-slate-100 text-center">
                                        <div id="dash-kpi-score" class="text-xl font-extrabold text-teal-700"></div>
                                        <div class="text-[10px] text-slate-500 uppercase">風險指數</div>
                                    </div>
                                    <div class="bg-white p-3 rounded-lg shadow-sm border border-slate-100 text-center">
                                        <div id="dash-kpi-factor" class="text-sm font-bold text-blue-700 mt-1"></div>
                                        <div class="text-[10px] text-slate-500 uppercase mt-1">最大因子</div>
                                    </div>
                                </div>
                                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4">
                                     <h3 class="text-xs font-semibold text-slate-500 mb-2 text-center">風險類別比較</h3>
                                     <div class="chart-container" style="height: 200px;"><canvas id="comparisonChart"></canvas></div>
                                </div>
                                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-4">
                                     <h3 class="text-xs font-semibold text-slate-500 mb-2 text-center">極端事件矩陣</h3>
                                     <div id="heatmapContainer" class="w-full h-[200px] border border-slate-100 rounded-lg overflow-hidden bg-slate-50"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`
        };

        // --- 3. 儀表板資料 (Dashboard Data) ---
        const dashboardEnergyData = [
            { id: 'wind', name: '離岸風電 (Offshore Wind)', riskLevel: 'High', description: '離岸風電首當其衝面臨極端風速增強與颱風路徑變動的挑戰。IPCC 報告指出，西北太平洋強颱強度預計增加，直接威脅風機結構完整性。', citations: [{text:'Pryor et al. (2020): 極端風速變異影響發電預測。',type:'數據模型'},{text:'Chen et al. (2021): 2050年後台海強颱機率增加15%。',type:'區域研究'},{text:'IPCC AR6: 海平面上升導致基樁疲勞壽命縮短。',type:'權威報告'}], resilience:'提升抗風等級至 IEC Class T，加強基樁抗淘刷保護。', radarData:[90,85,40,60,30], kpiScore:8.5, kpiFactor:'強烈颱風' },
            { id: 'wave', name: '波浪能 (Wave Energy)', riskLevel: 'Critical', description: '波浪能轉換器最易受極端海況破壞。極端波高（SWH）增加可能超過設備的「生存模式」極限，導致機械故障或繫泊系統斷裂。', citations: [{text:'Reguero et al. (2019): 全球波浪能通量隨海溫上升而增強。',type:'全球趨勢'},{text:'Toledo et al. (2022): 浮動式系泊系統疲勞風險分析。',type:'工程分析'}], resilience:'開發智慧潛沒保護模式，避開表層破壞性能量。', radarData:[95,90,20,85,20], kpiScore:9.2, kpiFactor:'極端波高' },
            { id: 'otec', name: '海洋溫差 (OTEC)', riskLevel: 'Medium', description: 'OTEC 依賴溫差，表層暖化雖好，但垂直混合與生物附著增加將大幅影響熱效率。', citations: [{text:'Grasset et al. (2018): 颱風過境造成表層海水冷卻，系統需停機。',type:'營運風險'},{text:'Langer et al. (2020): 海洋酸化加劇熱交換器生物附著。',type:'維護成本'}], resilience:'研發抗生物附著塗層，建立動態取水深度調節。', radarData:[30,20,80,40,75], kpiScore:5.4, kpiFactor:'溫差縮減' },
            { id: 'tidal', name: '潮汐能 (Tidal Range)', riskLevel: 'Med-High', description: '潮汐堰壩對海平面上升敏感，可能減少潮差效益。風暴潮疊加高潮位時，增加防洪操作複雜度。', citations: [{text:'Khojasteh et al. (2021): SLR 改變河口共振頻率與潮差。',type:'水動力學'},{text:'Environment Agency UK: 極端風暴潮排擠發電時間。',type:'案例研究'}], resilience:'適應性閘門控制策略，整合防洪與發電。', radarData:[50,70,60,30,50], kpiScore:6.8, kpiFactor:'海平面上升' },
            { id: 'current', name: '洋流能 (Ocean Current)', riskLevel: 'Medium', description: '黑潮路徑偏移（Meandering）將導致固定式發電場址容量因數大幅下降。', citations: [{text:'Yang et al. (2020): 聖嬰年黑潮路徑顯著偏移。',type:'海洋物理'},{text:'Chang et al. (2022): 颱風期間流場混亂影響渦輪穩定性。',type:'模擬實驗'}], resilience:'發展可移動式錨定系統以追蹤流軸。', radarData:[40,50,90,70,80], kpiScore:7.1, kpiFactor:'流軸偏移' },
            { id: 'stream', name: '潮流能 (Tidal Stream)', riskLevel: 'Medium', description: '極端底部流速導致沉積物沖刷，威脅海底電纜安全。', citations: [{text:'Neill et al. (2018): 風暴潮改變局部流速剖面。',type:'資源評估'},{text:'Fairley et al. (2020): 海底電纜磨損風險評估。',type:'設施安全'}], resilience:'加強電纜防護工程，避開沉積物活躍區。', radarData:[60,65,30,80,20], kpiScore:6.0, kpiFactor:'維運視窗' }
        ];

        let radarChartInstance = null;
        let comparisonChartInstance = null;
        // let skillsChartInstance = null; // Removed

        function initFullDashboard() {
            renderDashNav();
            selectDashEnergy('wind');
            renderDashComparisons();
            renderDashHeatmap();
        }

        function renderDashNav() {
            const container = document.getElementById('dash-nav-container');
            container.innerHTML = dashboardEnergyData.map(item => `
                <button onclick="selectDashEnergy('${item.id}')" id="dbtn-${item.id}"
                    class="d-btn w-full text-left px-3 py-3 rounded-lg text-sm font-medium text-slate-600 hover:text-teal-700 hover:bg-slate-50 transition-colors flex items-center justify-between group border border-transparent">
                    <span>${item.name}</span><span class="opacity-0 group-hover:opacity-100 text-teal-500">➜</span>
                </button>`).join('');
        }

        window.selectDashEnergy = function(id) {
            const data = dashboardEnergyData.find(e => e.id === id);
            document.querySelectorAll('.d-btn').forEach(btn => btn.classList.remove('bg-teal-50', 'text-teal-800', 'border-teal-200', 'shadow-sm'));
            document.getElementById(`dbtn-${id}`).classList.add('bg-teal-50', 'text-teal-800', 'border-teal-200', 'shadow-sm');

            document.getElementById('dash-section-title').textContent = data.name;
            const badge = document.getElementById('dash-risk-badge');
            badge.textContent = `${data.riskLevel} Risk`;
            badge.className = `px-3 py-1 rounded-full text-xs font-medium ${getBadgeColor(data.riskLevel)}`;
            
            document.getElementById('dash-desc-text').innerHTML = highlightKeywords(data.description);
            document.getElementById('dash-citation-list').innerHTML = data.citations.map(c => `
                <li class="bg-slate-50 p-2 rounded border-l-2 border-blue-400">
                    <span class="font-bold text-blue-600">[${c.type}]</span> ${c.text}
                </li>`).join('');
            document.getElementById('dash-resilience-text').textContent = data.resilience;
            
            animateValue("dash-kpi-score", 0, data.kpiScore, 500);
            document.getElementById('dash-kpi-factor').textContent = data.kpiFactor;
            updateDashRadar(data);

            // 手機版自動捲動邏輯
            if (window.innerWidth < 1024) { 
                const contentArea = document.getElementById('dash-content-main');
                if (contentArea) {
                    setTimeout(() => {
                        contentArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 50);
                }
            }
        };

        function updateDashRadar(data) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            if (radarChartInstance) radarChartInstance.destroy();
            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['極端天氣', '實體結構', '發電效率', '維運困難', '資源變異'],
                    datasets: [{ label: '風險值', data: data.radarData, fill: true, backgroundColor: 'rgba(15, 118, 110, 0.2)', borderColor: 'rgb(15, 118, 110)', pointBackgroundColor: 'rgb(15, 118, 110)', borderWidth: 2 }]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { r: { suggestedMin: 0, suggestedMax: 100, ticks: {display: false}, pointLabels: {font:{size:11}} } }, plugins: { legend: {display: false} } }
            });
        }

        function renderDashComparisons() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            if (comparisonChartInstance) comparisonChartInstance.destroy();
            const labels = dashboardEnergyData.map(e => e.name.split(' ')[0]);
            comparisonChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [ { label: '實體風險', data: dashboardEnergyData.map(e => (e.radarData[0]+e.radarData[1])/2), backgroundColor: '#0f766e', borderRadius: 4 }, { label: '營運風險', data: dashboardEnergyData.map(e => (e.radarData[2]+e.radarData[3])/2), backgroundColor: '#94a3b8', borderRadius: 4 } ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: {position:'bottom', labels:{boxWidth:10}} }, scales: { y: {beginAtZero: true}, x: {ticks:{font:{size:10}}} } }
            });
        }

        function renderDashHeatmap() {
            const riskEvents = [ { name: '強烈颱風(風)', x: 4, y: 4, val: 95 }, { name: '極端波浪(波)', x: 4, y: 3, val: 90 }, { name: '海溫上升(溫)', x: 2, y: 4, val: 70 }, { name: '海平面上升(潮)', x: 3, y: 4, val: 85 }, { name: '黑潮偏移(流)', x: 3, y: 2, val: 75 }, { name: '電纜沖刷(潮)', x: 2, y: 3, val: 65 } ];
            const data = [{ x: riskEvents.map(e => e.x), y: riskEvents.map(e => e.y), mode: 'markers', marker: { size: riskEvents.map(e => e.val * 0.5), color: riskEvents.map(e => e.val), colorscale: 'RdBu', showscale: false }, text: riskEvents.map(e => e.name), hovertemplate: '<b>%{text}</b><extra></extra>' }];
            const layout = { margin: { t: 10, r: 10, b: 40, l: 40 }, paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(248,250,252,1)', xaxis: { title: '衝擊', tickvals:[1,2,3,4], ticktext:['輕','中','重','災'], range:[0.5, 4.5] }, yaxis: { title: '機率', tickvals:[1,2,3,4], ticktext:['低','中','高','極'], range:[0.5, 4.5] } };
            Plotly.newPlot('heatmapContainer', data, layout, {displayModeBar: false, responsive: true});
        }

        function getBadgeColor(level) { if (level.includes('Critical')) return 'bg-red-100 text-red-800'; if (level.includes('High')) return 'bg-orange-100 text-orange-800'; return 'bg-yellow-100 text-yellow-800'; }
        function highlightKeywords(text) { const keywords = ['極端', '增加', '風險', '破壞', '下降', '上升']; let newText = text; keywords.forEach(kw => { newText = newText.replace(new RegExp(kw, 'g'), `<span class="text-teal-700 font-medium">${kw}</span>`); }); return newText; }
        function animateValue(id, start, end, duration) { const obj = document.getElementById(id); if(!obj) return; let startTimestamp = null; const step = (timestamp) => { if (!startTimestamp) startTimestamp = timestamp; const progress = Math.min((timestamp - startTimestamp) / duration, 1); obj.innerHTML = (progress * (end - start) + start).toFixed(1); if (progress < 1) window.requestAnimationFrame(step); }; window.requestAnimationFrame(step); }

        // --- 4. 路由與導航 (Routing) ---
        const navItems = [
            { id: 'about', label: '關於 (About)', icon: 'fas fa-user' },
            { id: 'publications', label: '研究著作 (Pubs)', icon: 'fas fa-book-open' },
            { id: 'courses', label: '課程 (Courses)', icon: 'fas fa-chalkboard-teacher' },
            { id: 'dashboard', label: '海洋能儀表板 (Dashboard)', icon: 'fas fa-chart-pie' },
        ];

        let currentFilter = 'all';

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderNav(); 
            handleRouting(); 
            window.addEventListener('hashchange', handleRouting);
        });

        function handleRouting() {
            const hash = window.location.hash.substring(1); 
            const validTabs = ['about', 'publications', 'courses', 'dashboard'];
            const tabId = validTabs.includes(hash) ? hash : 'about';
            renderTabContent(tabId);
        }

        function navigateTo(tabId) {
            window.location.hash = tabId;
        }

        function renderNav() {
            const dNav = document.getElementById('desktop-nav');
            const mNav = document.getElementById('mobile-nav');
            
            const createBtn = (id, label, icon) => `
                <button onclick="navigateTo('${id}')" id="nav-${id}" 
                    class="nav-item w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-slate-600 flex items-center group">
                    <span class="w-8 flex justify-center"><i class="${icon} group-hover:text-teal-600 transition-colors"></i></span>
                    ${label}
                </button>`;

            const createMobBtn = (id, label, icon) => `
                <button onclick="navigateTo('${id}')" id="mob-${id}" class="flex flex-col items-center text-slate-400 hover:text-teal-600">
                    <i class="${icon} text-lg mb-1"></i><span class="text-[10px]">${label.split(' ')[0]}</span>
                </button>`;

            dNav.innerHTML = navItems.map(i => createBtn(i.id, i.label, i.icon)).join('');
            mNav.innerHTML = navItems.map(i => createMobBtn(i.id, i.label, i.icon)).join('');
        }

        function renderTabContent(tabId) {
            // UI Active State
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${tabId}`)?.classList.add('active');
            document.querySelectorAll('#mobile-nav button').forEach(el => el.classList.remove('text-teal-700'));
            document.getElementById(`mob-${tabId}`)?.classList.add('text-teal-700');

            const main = document.getElementById('main-content');
            
            // Render Template
            if (tabId === 'dashboard') {
                main.innerHTML = contentTemplates.dashboard;
                setTimeout(initFullDashboard, 50);
            } else if (tabId === 'publications') {
                renderPublications(main);
            } else if (tabId === 'about') {
                main.innerHTML = contentTemplates.about;
            } else {
                main.innerHTML = contentTemplates[tabId];
            }
        }

        // --- Renderers ---

        function renderPublications(container) {
            container.innerHTML = `
                <div class="space-y-6 fade-in max-w-5xl mx-auto">
                    <div class="flex flex-col sm:flex-row items-center justify-between mb-4 gap-4">
                        <h2 class="text-2xl font-bold text-slate-800">研究著作 (Publications)</h2>
                        <div class="flex bg-white rounded-lg p-1 border border-slate-200 shadow-sm">
                            <button onclick="filterPubs('all')" id="btn-all" class="px-3 py-1 text-xs rounded-md transition-colors bg-teal-100 text-teal-800 font-bold">All</button>
                            <button onclick="filterPubs('journal')" id="btn-journal" class="px-3 py-1 text-xs rounded-md transition-colors text-slate-600 hover:bg-slate-50">Journal</button>
                            <button onclick="filterPubs('conf')" id="btn-conf" class="px-3 py-1 text-xs rounded-md transition-colors text-slate-600 hover:bg-slate-50">Conf</button>
                            <button onclick="filterPubs('book')" id="btn-book" class="px-3 py-1 text-xs rounded-md transition-colors text-slate-600 hover:bg-slate-50">Book</button>
                        </div>
                    </div>
                    <div id="pub-list" class="space-y-4"></div>
                </div>`;
            filterPubs('all');
        }

        window.filterPubs = function(type) {
            currentFilter = type;
            ['all', 'journal', 'conf', 'book'].forEach(t => {
                const btn = document.getElementById(`btn-${t}`);
                if(btn) btn.className = t === type ? "px-3 py-1 text-xs rounded-md transition-colors bg-teal-100 text-teal-800 font-bold" : "px-3 py-1 text-xs rounded-md transition-colors text-slate-600 hover:bg-slate-50";
            });

            const filtered = type === 'all' ? publicationsData : publicationsData.filter(p => p.type === type);
            document.getElementById('pub-list').innerHTML = filtered.map(pub => `
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow group relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full ${getTypeColor(pub.type)}"></div>
                    <div class="flex items-start justify-between">
                        <div class="pr-8">
                            <h3 class="text-lg font-bold text-slate-800 group-hover:text-teal-700 transition-colors mb-2 leading-snug">${pub.title}</h3>
                            <p class="text-sm text-slate-600 mb-2 leading-relaxed">${pub.authors}</p>
                            <div class="flex flex-wrap items-center gap-2 text-xs">
                                <span class="font-bold text-slate-700">${pub.journal}</span>
                                <span class="bg-slate-100 text-slate-500 px-2 py-0.5 rounded">${pub.year}</span>
                                ${pub.badge ? `<span class="bg-blue-50 text-blue-700 px-2 py-0.5 rounded border border-blue-100">${pub.badge}</span>` : ''}
                            </div>
                        </div>
                        <a href="${pub.link}" target="_blank" class="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-teal-500 hover:text-white transition-all"><i class="fas fa-external-link-alt text-xs"></i></a>
                    </div>
                </div>`).join('');
        };

        function getTypeColor(type) {
            if(type === 'journal') return 'bg-teal-500';
            if(type === 'conf') return 'bg-blue-400';
            return 'bg-purple-400';
        }
    </script>
</body>
</html>
